---
title: "12:34:16 AM - November 16, 2025"
date: 2025-11-16T00:34:16.433Z
timestamp: 1763253256433
---

## Project Notes

**VineDrawer Zendesk Integration - Async ref.read() Fix**

Fixed persistent "Using ref when widget is unmounted" error through 3 iterations:

**Problem Evolution:**
1. First error: ref.read() in _handleBugReport after async operations
2. Second error: ref.read() in dialog button onTap handlers  
3. Third error: ref.read() in _showSupportOptionsDialog called AFTER async operations

**Root Cause:**
Contact Support button workflow:
1. User taps button → onTap() executes
2. Navigator.pop() closes drawer → VineDrawer widget disposed
3. await Future.delayed(300ms) → widget stays unmounted
4. Calls _showSupportOptionsDialog(context, ref, ...) → PASSING UNMOUNTED REF
5. Method tries ref.read(provider) → ERROR

**Final Fix (3 levels):**
1. `onTap: () async` (line 223-224) - Capture bugReportService and userPubkey BEFORE Navigator.pop()
2. Pass captured VALUES to _showSupportOptionsDialog (line 241-246)
3. Update _showSupportOptionsDialog signature (line 384-389) - Accept values, not ref

**Files Modified:**
- `lib/widgets/vine_drawer.dart` lines 218-247 and 384-391

**Testing:**
- Hot reload should work (Dart-only changes)
- All Contact Support buttons should work without ref errors
- Zendesk ticket list should still work with UINavigationController wrapper
