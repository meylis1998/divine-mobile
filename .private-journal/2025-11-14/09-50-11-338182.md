---
title: "9:50:11 AM - November 14, 2025"
date: 2025-11-14T09:50:11.338Z
timestamp: 1763113811338
---

## Project Notes

## Android Loading Screen Hang - COMPLETE ROOT CAUSE ANALYSIS

**Symptom**: App hangs on loading screen in release APK/AAB builds, but works perfectly in debug builds and emulator

**Root Cause Confirmed**: R8 bytecode optimizer was enabled (`isMinifyEnabled = true`) but proguard-rules.pro was NEVER referenced in build.gradle.kts. R8 ran with only default Android rules, aggressively stripping:

1. **SharedPreferences platform channel** - Router redirect (app_router.dart:88) calls `SharedPreferences.getInstance()` to check TOS acceptance. Without platform channel, this async call hangs forever.
2. **Flutter engine classes** - Reflection-based initialization code
3. **Platform channel codecs** - MethodChannel, EventChannel, StandardMessageCodec
4. **Plugin registration** - All Flutter plugins use reflection

**How I Confirmed**:
- Checked build.gradle.kts line 58: `isMinifyEnabled = true` ✓
- Checked for proguardFiles reference: NONE ✗
- Verified proguard-rules.pro exists but is orphaned
- Traced router.dart redirect code that runs on every navigation

**Fix Applied**:
1. Added proguardFiles reference in build.gradle.kts release buildType
2. Added minimal ProGuard rules to preserve:
   - Flutter engine core (io.flutter.app.**, io.flutter.embedding.**)
   - Platform channels (io.flutter.plugin.common.**)
   - SharedPreferences (android.content.SharedPreferences)
   - Firebase (com.google.firebase.**, com.google.android.gms.**)
   - Native methods (JNI)

**Avoided Over-Engineering**:
- Did NOT keep all of androidx.** (too broad)
- Did NOT keep JSON serialization (not using Gson)
- Did NOT keep Lifecycle/RecyclerView (not the issue)

**Next Step**: MUST test release APK on physical device to verify fix
