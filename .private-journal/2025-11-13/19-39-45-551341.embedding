{
  "embedding": [
    -0.06444743275642395,
    -0.012502593919634819,
    0.0020843620877712965,
    -0.06588929891586304,
    0.009157834574580193,
    -0.0015319067751988769,
    0.009443562477827072,
    -0.049083609133958817,
    -0.04037374258041382,
    0.014019406400620937,
    -0.017514705657958984,
    -0.06974679231643677,
    -0.04931769147515297,
    0.07249771058559418,
    0.03530878946185112,
    -0.03761012479662895,
    0.08483920991420746,
    -0.09544408321380615,
    -0.04990694671869278,
    0.019213126972317696,
    -0.019407790154218674,
    -0.008804703131318092,
    0.06290489435195923,
    0.04791765660047531,
    -0.0033760082442313433,
    -0.04118897765874863,
    -0.017896048724651337,
    -0.05672644078731537,
    -0.018789710476994514,
    0.02514808624982834,
    0.02139749377965927,
    0.009885286912322044,
    -0.07250088453292847,
    -0.04977523162961006,
    -0.042484939098358154,
    -0.025117820128798485,
    -0.016936393454670906,
    -0.003939550835639238,
    -0.11153177917003632,
    -0.017923714593052864,
    0.06974029541015625,
    -0.0498523972928524,
    -0.08479864150285721,
    0.0025176454801112413,
    -0.005397708620876074,
    -0.015759868547320366,
    -0.0031704965513199568,
    -0.03191867470741272,
    0.010299491696059704,
    0.03511108085513115,
    -0.04055692255496979,
    0.03237677738070488,
    0.046838801354169846,
    -0.03182481601834297,
    0.037822071462869644,
    0.017332009971141815,
    0.05621756985783577,
    0.10023577511310577,
    0.05205163359642029,
    -0.012888147495687008,
    -0.001129925367422402,
    -0.028140906244516373,
    -0.009632214903831482,
    -0.02587927132844925,
    0.027408432215452194,
    0.022891629487276077,
    -0.04086214676499367,
    0.054990608245134354,
    0.1118692010641098,
    -0.038270220160484314,
    0.0009199382038787007,
    0.08579181879758835,
    0.0490441657602787,
    -0.03894132748246193,
    -0.04490147531032562,
    -0.08965406566858292,
    -0.004003526642918587,
    0.016520299017429352,
    0.0032597759272903204,
    -0.12481671571731567,
    -0.053109776228666306,
    -0.06692179292440414,
    0.03361789509654045,
    0.0178944431245327,
    0.06152889505028725,
    0.0692230686545372,
    0.012394006364047527,
    -0.05723177269101143,
    0.0021566993091255426,
    0.05977734923362732,
    0.02002526819705963,
    0.06113802641630173,
    -0.031147276982665062,
    -0.05741943046450615,
    0.08254873752593994,
    0.003738557919859886,
    0.023380383849143982,
    -0.014593538828194141,
    -0.03331639990210533,
    0.0279676653444767,
    0.014636640436947346,
    0.024334676563739777,
    0.03456804156303406,
    0.12516333162784576,
    0.11069720983505249,
    -0.04439748451113701,
    0.006398241966962814,
    -0.029120050370693207,
    0.010508346371352673,
    -0.008863680996000767,
    0.02418111078441143,
    -0.039079081267118454,
    0.06282217800617218,
    -0.015804026275873184,
    -0.001412595622241497,
    0.02557978965342045,
    -0.11748114973306656,
    0.019073467701673508,
    0.023711053654551506,
    0.08862001448869705,
    0.0687066987156868,
    -0.03709406405687332,
    -0.008359790779650211,
    -0.019332190975546837,
    0.03936098515987396,
    0.06899553537368774,
    0.04453837126493454,
    6.9373694598418e-33,
    0.033659402281045914,
    -0.08664236217737198,
    -0.0687740296125412,
    0.08327632397413254,
    0.026704732328653336,
    0.026771655306220055,
    -0.0349249541759491,
    0.026941750198602676,
    0.008041879162192345,
    -0.0461757518351078,
    0.01758129894733429,
    -0.011865304782986641,
    -0.034976571798324585,
    -0.03413496911525726,
    0.03428349271416664,
    -0.06375188380479813,
    -0.053946249186992645,
    -0.04575616866350174,
    0.027831243351101875,
    0.02687200903892517,
    0.08537740260362625,
    -0.016260437667369843,
    -0.08099407702684402,
    -0.06509437412023544,
    -0.04206569492816925,
    -0.025900358334183693,
    0.00988832488656044,
    0.03190081566572189,
    -0.0199168361723423,
    0.03225519880652428,
    0.008998533710837364,
    -0.021663134917616844,
    0.06100692227482796,
    0.0033682198263704777,
    -0.05387048423290253,
    -0.05918952077627182,
    0.002711251378059387,
    -0.04090709611773491,
    -0.08443434536457062,
    -0.11691402643918991,
    -0.032495468854904175,
    -0.023282315582036972,
    -0.1143786683678627,
    -0.025305602699518204,
    -0.04247080162167549,
    -0.11928411573171616,
    0.01720838062465191,
    -0.03838682547211647,
    0.03592956066131592,
    0.04102029651403427,
    -0.03342391550540924,
    0.02439100667834282,
    -0.027873363345861435,
    -0.09585539251565933,
    -0.04166692867875099,
    -0.01967424526810646,
    -0.005404905881732702,
    -0.006427217274904251,
    -0.030500497668981552,
    -0.07976672053337097,
    -0.02381141483783722,
    -0.03978922590613365,
    -0.02727973833680153,
    0.0009296640637330711,
    0.023337576538324356,
    0.06616802513599396,
    0.021668432280421257,
    -0.005448533222079277,
    0.015781525522470474,
    -0.08144993335008621,
    -0.08698401600122452,
    -0.025925107300281525,
    0.01575973629951477,
    0.012917870655655861,
    0.007736884523183107,
    0.009440788067877293,
    0.09071428328752518,
    0.0022804473992437124,
    -0.13648687303066254,
    -0.06122555211186409,
    0.007525265216827393,
    -0.010875415988266468,
    -0.031432755291461945,
    0.10271082818508148,
    0.042295221239328384,
    -0.0376187227666378,
    0.060924869030714035,
    -0.09887849539518356,
    -0.038269493728876114,
    0.047287717461586,
    0.0598340779542923,
    0.013224787078797817,
    0.10067010670900345,
    0.005483068525791168,
    -0.02065158821642399,
    -8.591119564767889e-33,
    0.007062161341309547,
    -0.03279607370495796,
    -0.05389508232474327,
    0.00844643171876669,
    0.08831357955932617,
    -0.04966578260064125,
    0.02484070137143135,
    0.04341971501708031,
    0.06516694277524948,
    -0.06842376291751862,
    -0.020523186773061752,
    0.06345926225185394,
    -0.05458775535225868,
    0.01761665940284729,
    -0.09128240495920181,
    0.03728051111102104,
    0.03104168176651001,
    -0.02455151453614235,
    0.01727423444390297,
    -0.0006987902452237904,
    0.002361374208703637,
    0.09696870297193527,
    0.04877815768122673,
    -0.02340366318821907,
    0.0007235002121888101,
    0.022944482043385506,
    0.07076922804117203,
    0.004298656713217497,
    0.020075630396604538,
    -0.0909372940659523,
    0.10849709063768387,
    -0.01213128212839365,
    -0.05975012108683586,
    0.09443435817956924,
    0.007686235476285219,
    -0.007425511255860329,
    0.09178700298070908,
    0.021869584918022156,
    -0.11504238843917847,
    0.025618605315685272,
    0.15500140190124512,
    -0.0011924871942028403,
    -0.04050152376294136,
    -0.03660302609205246,
    0.03698267787694931,
    0.04064452275633812,
    0.01319108996540308,
    -0.006043137051165104,
    -0.12965555489063263,
    -0.01268948893994093,
    0.059024859219789505,
    -0.0036033117212355137,
    0.02539319358766079,
    0.03619949147105217,
    -0.011892760172486305,
    0.03582894057035446,
    0.1505192369222641,
    -0.0027924119494855404,
    -0.03671101853251457,
    -0.01016850583255291,
    0.049957141280174255,
    -0.023993972688913345,
    -0.03433753550052643,
    0.02258463017642498,
    -0.028005558997392654,
    -0.003922840114682913,
    0.016585128381848335,
    0.17107762396335602,
    0.11373327672481537,
    -0.03241647407412529,
    -0.0046096076257526875,
    -0.029954036697745323,
    0.010225122794508934,
    0.0023942184634506702,
    0.054091110825538635,
    0.016396047547459602,
    -0.03048623725771904,
    -0.06743385642766953,
    0.015838220715522766,
    -0.03429245203733444,
    -0.09331882745027542,
    0.0663142204284668,
    -0.009833927266299725,
    -0.07475639134645462,
    0.0055211265571415424,
    0.009598713368177414,
    0.004166720435023308,
    0.0502040721476078,
    0.06882712990045547,
    0.05284480005502701,
    -0.0022253876086324453,
    -0.05436091870069504,
    -0.06327607482671738,
    0.07996051013469696,
    0.040631670504808426,
    -5.832112393022726e-8,
    -0.03867035731673241,
    0.05211897939443588,
    -0.023958519101142883,
    0.06309337913990021,
    0.027729298919439316,
    -0.05499311909079552,
    0.06248439475893974,
    -0.06085274741053581,
    -0.02882961742579937,
    -0.0710885301232338,
    -0.02414102293550968,
    0.05025339499115944,
    -0.02666083350777626,
    -0.05845324695110321,
    0.05693649873137474,
    -0.05275317654013634,
    -0.014658013358712196,
    -0.04431943967938423,
    -0.0748211070895195,
    -0.029471687972545624,
    -0.03427596390247345,
    -0.018546072766184807,
    -0.04349830374121666,
    0.008703939616680145,
    -0.13433851301670074,
    0.027832265943288803,
    0.028385180979967117,
    -0.0359228178858757,
    0.022533178329467773,
    -0.0336165651679039,
    -0.02725495770573616,
    0.04000662639737129,
    0.0023970853071659803,
    -0.07198746502399445,
    -0.05874122679233551,
    0.0468500480055809,
    -0.028119700029492378,
    -0.011597654782235622,
    0.09472552686929703,
    0.0687311664223671,
    0.010104541666805744,
    -0.009195337072014809,
    -0.0044779120944440365,
    -0.022794922813773155,
    -0.026138637214899063,
    0.0040244669653475285,
    -0.010297710075974464,
    -0.007098243106156588,
    0.07639474421739578,
    -0.04952103644609451,
    -0.014513460919260979,
    0.054265838116407394,
    -0.01903725415468216,
    0.028770461678504944,
    0.04553084820508957,
    0.02763902023434639,
    0.019063200801610947,
    -0.08079755306243896,
    0.009176807478070259,
    -0.03475381061434746,
    0.09357757121324539,
    0.008326270617544651,
    0.05246996507048607,
    0.031711384654045105
  ],
  "text": "**Age Gate Race Condition - FIXED**\n\nSuccessfully debugged and fixed the race condition where users couldn't accept the terms of service on WelcomeScreen.\n\n**Root Cause**: \n- WelcomeScreen was watching `authServiceProvider` (the AuthService instance)\n- When auth state changed, only StreamController emitted events\n- The AuthService instance itself didn't change â†’ Riverpod didn't rebuild the UI\n- Result: Button never appeared even after auth completed\n\n**Fix Applied**:\n1. Created `authStateStreamProvider` in app_providers.dart (lines 228-239)\n   - Uses `async*` generator to emit current state immediately, then stream future changes\n2. Updated WelcomeScreen to watch `authStateStreamProvider` instead of `authService.authState` (lines 29-39)\n   - Uses `.when()` to handle loading/error states properly\n3. Added TDD test for race condition (welcome_screen_auth_state_test.dart)\n   - Test simulates auth state changing after widget build\n   - Confirms UI rebuilds when auth completes\n\n**Files Changed**:\n- mobile/lib/providers/app_providers.dart - Added authStateStreamProvider\n- mobile/lib/screens/welcome_screen.dart - Watch stream instead of service property  \n- mobile/lib/providers/social_providers.dart - Fixed compilation errors (missing socialService refs)\n- mobile/test/screens/welcome_screen_auth_state_test.dart - Added race condition test, updated all tests to mock stream provider\n\n**Pattern to Remember**: When using StreamController in a service, widgets must watch a StreamProvider, not the service property directly. The service instance doesn't change when internal state changes.",
  "sections": [
    "Project Notes"
  ],
  "timestamp": 1763062785551,
  "path": "/Users/rabble/code/andotherstuff/openvine/.private-journal/2025-11-13/19-39-45-551341.md"
}