---
title: "7:41:39 PM - November 13, 2025"
date: 2025-11-13T19:41:39.106Z
timestamp: 1763062899106
---

## Project Notes

**Critical Discovery: Profile Editing Black Screen**

Root Cause: Race condition between profile publish and navigation
- Relay needs time to process published event
- App invalidates provider + navigates immediately
- Profile screen refetches, gets stale/null data
- UI fails to render â†’ black screen

**The Twist**: Fix was already designed and tested but never implemented!
- Test exists: `profile_editing_race_condition_test.dart`
- Utility exists: `AsyncUtils.retryWithBackoff` 
- Production code DOESN'T use it

**Fix Strategy**:
After line 837 (event broadcast), before line 932 (navigation):
1. Use `AsyncUtils.retryWithBackoff` to fetch profile from relay
2. Validate fetched profile matches published event (by event ID or timestamp)
3. Retry with exponential backoff if stale
4. Only navigate after confirmed updated profile available

This explains the intermittent nature perfectly - fast relays work, slow relays fail.
