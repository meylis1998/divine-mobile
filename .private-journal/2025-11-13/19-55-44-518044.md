---
title: "7:55:44 PM - November 13, 2025"
date: 2025-11-13T19:55:44.518Z
timestamp: 1763063744518
---

## Project Notes

Fixed loading screen deadlock bug in AuthService:

**Changes Made**:
1. Removed all `addPostFrameCallback` wrappers around `_setAuthState()` calls
2. Made state transitions synchronous in error handlers (lines 144, 543, 549)
3. Removed redundant state change before `createNewIdentity()` (line 528-530)

**Files Modified**:
- mobile/lib/services/auth_service.dart

**Rationale**:
The addPostFrameCallback wrappers were causing deadlocks because:
- Loading spinner prevents frame rendering
- Callback never executes if no frames rendered
- Auth state never transitions to unauthenticated
- User stuck on loading screen forever

**Solution**:
Set auth state synchronously. The "setState during build" concern that likely prompted the callbacks is not an issue here because AuthService uses StreamController, not ChangeNotifier.
