{
  "embedding": [
    -0.026154981926083565,
    -0.0462019182741642,
    -0.004111561458557844,
    -0.08092683553695679,
    0.06765881925821304,
    -0.008203234523534775,
    0.03155146911740303,
    0.010335327126085758,
    0.030717456713318825,
    0.0588662214577198,
    0.01088534202426672,
    -0.04151633381843567,
    -0.04062412679195404,
    0.021741263568401337,
    -0.05039554461836815,
    0.000013914031114836689,
    0.04089418053627014,
    -0.049566611647605896,
    -0.061644650995731354,
    0.050980135798454285,
    0.013749323785305023,
    -0.00577589962631464,
    0.04290714114904404,
    0.02437981590628624,
    -0.025640122592449188,
    -0.043305300176143646,
    0.009027289226651192,
    -0.04063521698117256,
    -0.057668063789606094,
    -0.0060868775472044945,
    0.02506430819630623,
    0.043271224945783615,
    -0.0631970763206482,
    -0.002340832957997918,
    0.035482555627822876,
    0.04670042544603348,
    -0.08816693723201752,
    -0.08816377073526382,
    -0.12959089875221252,
    -0.06462854146957397,
    -0.03321817144751549,
    0.06258788704872131,
    -0.028597529977560043,
    0.0022714834194630384,
    -0.05981331691145897,
    -0.019893884658813477,
    0.009056254290044308,
    -0.055736225098371506,
    -0.0371374636888504,
    -0.013891669921576977,
    -0.09295428544282913,
    0.06113409250974655,
    -0.02169342152774334,
    -0.028046628460288048,
    0.05662618950009346,
    0.01871064119040966,
    -0.02590940333902836,
    0.04005584120750427,
    0.01735636033117771,
    0.08282575756311417,
    0.0650734081864357,
    -0.022393180057406425,
    0.03381967544555664,
    -0.03535429388284683,
    0.052954692393541336,
    0.03030293993651867,
    0.05204060673713684,
    -0.06434603035449982,
    0.0924363061785698,
    0.003852216526865959,
    -0.050384048372507095,
    0.047649577260017395,
    -0.026651844382286072,
    -0.02134542167186737,
    -0.0575159452855587,
    -0.06944478303194046,
    0.03620471432805061,
    -0.060568202286958694,
    -0.06123663857579231,
    -0.13257287442684174,
    -0.009553580544888973,
    -0.0301328357309103,
    -0.02675161510705948,
    -0.02965104579925537,
    0.1043395921587944,
    -0.008133823052048683,
    -0.03024568222463131,
    -0.010663371533155441,
    0.0992627963423729,
    0.03176061809062958,
    -0.0439440980553627,
    0.03593704476952553,
    0.027570726349949837,
    -0.0014982812572270632,
    0.0921349823474884,
    -0.03681257739663124,
    0.06025156006217003,
    -0.023514563217759132,
    -0.04280324652791023,
    0.038105569779872894,
    -0.018273236230015755,
    0.015332881361246109,
    0.056988175958395004,
    0.11140085011720657,
    0.04808193817734718,
    -0.028879139572381973,
    0.051099132746458054,
    0.06200680509209633,
    -0.08960645645856857,
    -0.015536217950284481,
    0.0345868282020092,
    0.011699174530804157,
    -0.0015674610622227192,
    0.030913889408111572,
    0.04642539098858833,
    0.05959378182888031,
    -0.05426974594593048,
    0.03728954493999481,
    -0.03698296099901199,
    0.13148675858974457,
    0.08925849944353104,
    -0.024814777076244354,
    0.012674469500780106,
    -0.07347720861434937,
    -0.008631540462374687,
    0.045265473425388336,
    0.05367505922913551,
    6.516257424867346e-33,
    0.013095017522573471,
    -0.07559046149253845,
    -0.038054514676332474,
    0.03141694515943527,
    0.011866799555718899,
    0.001186233013868332,
    0.03728272765874863,
    0.08025197684764862,
    -0.026437856256961823,
    -0.049773264676332474,
    0.06405186653137207,
    -0.05318458750844002,
    -0.04376677796244621,
    0.026698840782046318,
    0.04234644025564194,
    -0.0967797040939331,
    0.03882336616516113,
    0.004677985794842243,
    -0.011766883544623852,
    0.022702956572175026,
    0.0887375921010971,
    0.00794602744281292,
    -0.10153299570083618,
    -0.07214413583278656,
    -0.013134993612766266,
    0.06275687366724014,
    0.02560947649180889,
    0.022751016542315483,
    0.005086872261017561,
    0.03571481630206108,
    -0.0811084657907486,
    -0.033342283219099045,
    -0.010560893453657627,
    -0.04202659800648689,
    0.00375727703794837,
    -0.01195443980395794,
    -0.0693369060754776,
    0.011754048056900501,
    -0.038538675755262375,
    -0.07098928093910217,
    -0.10193518549203873,
    0.0030138902366161346,
    -0.11172576993703842,
    -0.04753528907895088,
    -0.03987256810069084,
    -0.11805788427591324,
    -0.0506003275513649,
    0.06723376363515854,
    -0.052128490060567856,
    0.02592247910797596,
    0.006796305999159813,
    0.006957006175071001,
    0.019477244466543198,
    -0.09559430927038193,
    -0.06614241749048233,
    -0.02583455480635166,
    0.029072275385260582,
    -0.004180493764579296,
    0.032117560505867004,
    0.012585140764713287,
    0.02466236799955368,
    -0.020049208775162697,
    -0.014591001905500889,
    0.01867152377963066,
    -0.02826603874564171,
    0.0386827327311039,
    0.04050228372216225,
    0.00003415671380935237,
    -0.014351978898048401,
    0.004926423076540232,
    -0.05431240051984787,
    0.0103316530585289,
    0.1209583654999733,
    -0.051655113697052,
    0.03485263139009476,
    -0.011762247420847416,
    -0.09088965505361557,
    -0.02658296748995781,
    -0.15984182059764862,
    -0.027646852657198906,
    0.020637542009353638,
    -0.025876890867948532,
    -0.02154872566461563,
    0.006688412744551897,
    -0.03303693234920502,
    -0.05581020936369896,
    0.04752252623438835,
    -0.04504275321960449,
    -0.08254001289606094,
    0.07466550916433334,
    -0.014188362285494804,
    -0.031767550855875015,
    0.07613008469343185,
    -0.041825294494628906,
    -0.030342228710651398,
    -7.482123664055588e-33,
    -0.001690060249529779,
    -0.0285956934094429,
    -0.022391224279999733,
    -0.016722071915864944,
    0.04523200914263725,
    -0.07410187274217606,
    -0.010053416714072227,
    0.025794390588998795,
    -0.021618397906422615,
    -0.14371609687805176,
    -0.1216399222612381,
    0.03954851254820824,
    -0.0832219272851944,
    -0.01732984371483326,
    -0.03571810573339462,
    0.06644655764102936,
    0.03070487268269062,
    -0.07596088200807571,
    -0.0071411170065402985,
    0.005295213777571917,
    -0.0038986322470009327,
    0.06820634752511978,
    0.01195602398365736,
    -0.04074191302061081,
    0.0007709710043855011,
    0.07458047568798065,
    0.08844966441392899,
    0.079656682908535,
    0.06271311640739441,
    -0.05639292672276497,
    0.10150043666362762,
    -0.010138272307813168,
    -0.04554168879985809,
    0.05035756900906563,
    0.059942830353975296,
    0.03678417578339577,
    0.02323620207607746,
    -0.034773558378219604,
    -0.1624104529619217,
    0.006470774300396442,
    0.1719096451997757,
    0.03465624153614044,
    -0.021171612665057182,
    0.058054935187101364,
    0.048256464302539825,
    0.041050996631383896,
    0.054839279502630234,
    0.0022818390280008316,
    -0.055615153163671494,
    -0.047658953815698624,
    0.04310072585940361,
    -0.017101392149925232,
    -0.014215018600225449,
    -0.011170616373419762,
    -0.0014652842655777931,
    0.05915967747569084,
    0.059943292289972305,
    0.033049505203962326,
    0.013483910821378231,
    -0.052845872938632965,
    0.10909122973680496,
    -0.030551111325621605,
    -0.07613004744052887,
    0.0074030552059412,
    0.0528876818716526,
    0.0007396439323201776,
    -0.0008491497137583792,
    0.042369186878204346,
    0.03216922655701637,
    -0.003443070687353611,
    0.05156472697854042,
    0.021067030727863312,
    0.003236691001802683,
    -0.04719298705458641,
    0.027219269424676895,
    0.08210166543722153,
    -0.0038291250821202993,
    -0.02603386528789997,
    0.02379724383354187,
    0.002191530540585518,
    -0.06950836628675461,
    -0.060371652245521545,
    0.05219243839383125,
    -0.006534717045724392,
    -0.0174394641071558,
    0.003255545860156417,
    -0.047760624438524246,
    0.08528970181941986,
    0.008621594868600368,
    -0.028418101370334625,
    -0.02491585724055767,
    -0.011494423262774944,
    -0.029578328132629395,
    0.021032920107245445,
    -0.012847903184592724,
    -5.4077215594361405e-8,
    -0.037542808800935745,
    0.013156895525753498,
    -0.040323853492736816,
    0.08672624826431274,
    0.01943989098072052,
    -0.06854119151830673,
    0.06122303754091263,
    0.026097986847162247,
    0.014108153060078621,
    0.0014602293958887458,
    0.04523593559861183,
    -0.030357981100678444,
    -0.008671803399920464,
    -0.00485093193128705,
    0.03172796219587326,
    -0.032235562801361084,
    -0.011392890475690365,
    0.04007380083203316,
    -0.08682124316692352,
    0.011602658778429031,
    -0.037017542868852615,
    -0.014064565300941467,
    -0.02433972805738449,
    -0.06292173266410828,
    -0.10098310559988022,
    0.01357315480709076,
    0.011347439140081406,
    0.014448419213294983,
    0.02735835500061512,
    -0.04256095737218857,
    0.007324350532144308,
    0.008713282644748688,
    0.03225458413362503,
    0.002914572600275278,
    -0.048991281539201736,
    0.0630221888422966,
    0.027575472369790077,
    0.02408112771809101,
    0.12248840928077698,
    0.07091043144464493,
    -0.0360308475792408,
    -0.005217690020799637,
    0.027526579797267914,
    0.04043770954012871,
    -0.03579853102564812,
    0.010575215332210064,
    -0.05787669122219086,
    -0.010010942816734314,
    0.04813467338681221,
    0.04020555689930916,
    -0.1087222769856453,
    0.01231363881379366,
    -0.09249720722436905,
    0.04631790518760681,
    0.03264317661523819,
    -0.0025512007996439934,
    0.08252837508916855,
    -0.03669559210538864,
    -0.007149376440793276,
    -0.0008741404162719846,
    0.09712611138820648,
    -0.011034253053367138,
    -0.01767105609178543,
    0.045997850596904755
  ],
  "text": "**Issue**: `Could not find corresponding view type for playerId: X` causing FATAL crashes (67 events, 57 users)\n\n**Root Cause Identified**: Race condition between widget rebuild and native platform view lifecycle\n\n### The Problem\n\n1. **Disposal in microtask**: Controller disposal happens asynchronously in `Future.microtask()` (individual_video_providers.dart:391-398)\n2. **Rapid navigation**: Camera ↔ Explore screen transitions trigger fast widget mount/unmount cycles\n3. **Platform view mismatch**: VideoPlayer widget tries to build before native view is ready or after it's destroyed\n\n### Technical Flow\n\n```\nUser navigates: Explore → Camera → Explore (rapid)\n├─ Explore unmounts → isActive=false → provider starts disposal\n├─ Provider.onDispose() schedules controller.dispose() in microtask\n├─ User taps back quickly → Explore mounts again\n├─ New widget builds → reads same controller provider (keepAlive cache)\n├─ VideoPlayer(controller) renders → calls buildViewWithOptions\n└─ ERROR: Native playerId view was destroyed or not created yet\n```\n\n### Key Code Locations\n\n- **Controller Provider**: `mobile/lib/providers/individual_video_providers.dart:100-406`\n  - Line 108-123: keepAlive with 5-minute cache (prevents codec churn)\n  - Line 381-399: onDispose with microtask disposal (THE PROBLEM)\n  \n- **VideoPlayer Widget**: `mobile/lib/widgets/video_feed_item.dart:439`\n  - Conditional rendering based on `isActive`\n  - No defensive checks for controller state\n\n### Why It Happens\n\nThe 5-minute keepAlive cache (line 108) is excellent for performance but creates a window where:\n- Widget thinks controller is valid (cached)\n- Native platform view was disposed\n- Rebuild happens before native view recreates\n\n### Crashlytics Pattern\n\nFrom crash logs:\n- Always from `explore_screen` ↔ `camera` navigation breadcrumbs\n- Various playerId values (1, 4, 11, 31, 32) - not a specific instance leak\n- Happens during widget rebuild: `_VideoPlayerState.build` → `AVFoundationVideoPlayer.buildViewWithOptions`\n\n### Solution Approaches\n\n1. **Defensive rendering**: Check controller.value.isInitialized before rendering VideoPlayer widget\n2. **Synchronous disposal**: Don't use Future.microtask, dispose immediately\n3. **Platform view state tracking**: Add native view existence check before buildViewWithOptions\n4. **Widget key management**: Force new VideoPlayer instance on remount with unique keys\n\nNeed to decide which approach to take.",
  "sections": [
    "Project Notes",
    "AVFoundationVideoPlayer Crash Root Cause"
  ],
  "timestamp": 1763475599232,
  "path": "/Users/rabble/code/andotherstuff/openvine/.private-journal/2025-11-18/06-19-59-232081.md"
}