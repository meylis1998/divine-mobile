{
  "embedding": [
    -0.05721936374902725,
    -0.03247684985399246,
    -0.06729678064584732,
    -0.049077510833740234,
    0.05668725445866585,
    -0.017817961052060127,
    0.05990234762430191,
    -0.012003133073449135,
    0.03133504092693329,
    0.014384058304131031,
    0.07439311593770981,
    -0.009860488586127758,
    -0.023229796439409256,
    -0.022799165919423103,
    -0.033200688660144806,
    -0.019899964332580566,
    -0.07246461510658264,
    -0.018128516152501106,
    -0.057643529027700424,
    0.01155782863497734,
    0.050217967480421066,
    0.033046577125787735,
    0.07348102331161499,
    0.037150461226701736,
    0.011097758077085018,
    0.0035081494133919477,
    -0.06314806640148163,
    -0.050369858741760254,
    -0.029170872643589973,
    -0.03447076305747032,
    0.07285837829113007,
    0.08432740718126297,
    0.00022678467212244868,
    0.03362478315830231,
    0.07531651109457016,
    -0.029746849089860916,
    0.0038674259558320045,
    -0.02542945183813572,
    -0.08736571669578552,
    -0.06151025742292404,
    0.009331502951681614,
    0.05641889199614525,
    -0.09100954979658127,
    -0.028553500771522522,
    -0.08603902161121368,
    -0.008392938412725925,
    -0.07603719085454941,
    -0.05168335139751434,
    0.004565627314150333,
    0.009223323315382004,
    -0.06768422573804855,
    0.027052046731114388,
    -0.047393135726451874,
    0.04592110961675644,
    0.04466422647237778,
    0.03235567733645439,
    0.020626775920391083,
    0.05831919610500336,
    0.018773997202515602,
    0.07725894451141357,
    0.007714992389082909,
    -0.007628474850207567,
    -0.04577236250042915,
    -0.02522922120988369,
    0.004326678346842527,
    0.011065585538744926,
    0.008966485969722271,
    0.005737576633691788,
    0.059055618941783905,
    0.001514986390247941,
    -0.06092362850904465,
    0.07514297962188721,
    -0.06682715564966202,
    -0.006779200863093138,
    -0.05835755169391632,
    -0.02614547312259674,
    0.024653296917676926,
    0.016272565349936485,
    -0.08655549585819244,
    -0.12554292380809784,
    0.007092034909874201,
    -0.06372302770614624,
    0.0657535120844841,
    0.02201882004737854,
    0.012617547996342182,
    -0.03140302747488022,
    -0.00616847351193428,
    -0.07232234627008438,
    0.038852572441101074,
    0.0659119114279747,
    -0.09257836639881134,
    -0.011880277656018734,
    0.01775030791759491,
    -0.013690938241779804,
    -0.015133839100599289,
    -0.00028593555907718837,
    0.006727759260684252,
    0.028814109042286873,
    -0.005180219653993845,
    0.04528779536485672,
    0.019370386376976967,
    0.006747093982994556,
    0.03688454255461693,
    0.04723680391907692,
    0.029045097529888153,
    -0.026829205453395844,
    0.02436269260942936,
    -0.0018547283252701163,
    -0.04727860912680626,
    0.026532020419836044,
    0.019120607525110245,
    0.06595461070537567,
    -0.0069035934284329414,
    -0.042098890990018845,
    0.09379753470420837,
    0.07184460014104843,
    -0.030184481292963028,
    0.07241969555616379,
    -0.01327053178101778,
    0.10745242238044739,
    0.10182179510593414,
    0.0018947736825793982,
    -0.010119863785803318,
    -0.012297248467803001,
    -0.02536991611123085,
    -0.01793687604367733,
    0.05861218646168709,
    7.799670238618782e-33,
    0.06324152648448944,
    -0.1082640290260315,
    -0.053732771426439285,
    0.010517396964132786,
    0.0575840100646019,
    0.03247382491827011,
    -0.02094937674701214,
    0.06319240480661392,
    -0.026003913953900337,
    -0.04833446070551872,
    0.02287919446825981,
    -0.005461986642330885,
    -0.03282605856657028,
    0.037939779460430145,
    0.01871688850224018,
    -0.044468630105257034,
    -0.0010536708869040012,
    0.09879421442747116,
    0.007045627571642399,
    0.03773330897092819,
    0.05846444517374039,
    0.001249887514859438,
    -0.0404188334941864,
    0.0011914364295080304,
    0.028336381539702415,
    0.041995368897914886,
    0.02953091822564602,
    -0.0017310631228610873,
    0.020881973206996918,
    0.03726264089345932,
    -0.07429993897676468,
    -0.03661889210343361,
    0.07026167213916779,
    -0.041213300079107285,
    0.0029917943757027388,
    0.044256631284952164,
    -0.06090103089809418,
    -0.02443554997444153,
    -0.05519656464457512,
    -0.06569547206163406,
    -0.008903349749743938,
    0.004695271607488394,
    -0.09137070924043655,
    -0.08107186108827591,
    -0.07663041353225708,
    -0.13682012259960175,
    -0.04836892709136009,
    0.12524446845054626,
    -0.012352081015706062,
    0.08986059576272964,
    0.04341982677578926,
    0.029619481414556503,
    0.02008037082850933,
    -0.11309897154569626,
    -0.0664186105132103,
    -0.014411205425858498,
    0.026376789435744286,
    -0.027027321979403496,
    0.028865594416856766,
    -0.004876673221588135,
    0.014122631400823593,
    0.0709114521741867,
    -0.038729988038539886,
    -0.024612242355942726,
    0.02201136015355587,
    0.06956478953361511,
    -0.009432761929929256,
    -0.011228462681174278,
    0.051896777004003525,
    -0.03787998855113983,
    -0.15258631110191345,
    0.015519377775490284,
    0.02177928015589714,
    -0.054385244846343994,
    0.04232911765575409,
    -0.07304811477661133,
    -0.06152702122926712,
    -0.006746497005224228,
    -0.10694991052150726,
    -0.008866599760949612,
    -0.004988904111087322,
    -0.020357513800263405,
    -0.01840517669916153,
    -0.04123968258500099,
    -0.02280506119132042,
    -0.020410005003213882,
    0.08791746944189072,
    -0.03778260946273804,
    -0.08666408807039261,
    0.021931955590844154,
    -0.02152330055832863,
    0.014964933507144451,
    0.032777413725852966,
    -0.010494348593056202,
    -0.03473145514726639,
    -8.639618257630909e-33,
    0.05610114336013794,
    0.0451926551759243,
    -0.025665462017059326,
    -0.016926150768995285,
    0.02290111407637596,
    -0.041382014751434326,
    -0.018712447956204414,
    0.05707026645541191,
    -0.051017384976148605,
    -0.14594265818595886,
    -0.10738284140825272,
    -0.04150449112057686,
    -0.03772546350955963,
    -0.06553216278553009,
    -0.008222230710089207,
    -0.006761371158063412,
    -0.035867031663656235,
    -0.08365104347467422,
    -0.06613828986883163,
    0.006059926003217697,
    -0.02800815738737583,
    0.03168061003088951,
    0.1046416312456131,
    0.06928545236587524,
    -0.06035574525594711,
    -0.01071325782686472,
    0.01327334064990282,
    0.06181415915489197,
    0.08838579058647156,
    -0.07440344244241714,
    0.11318451166152954,
    -0.01712757907807827,
    -0.1139468401670456,
    -0.04717531427741051,
    0.010268761776387691,
    -0.06265386939048767,
    0.0005697214510291815,
    0.08271272480487823,
    -0.017691751942038536,
    0.03175286948680878,
    0.11178311705589294,
    0.029470987617969513,
    -0.026482297107577324,
    -0.01902724616229534,
    0.019063377752900124,
    0.007866417057812214,
    0.03249591588973999,
    0.11868271231651306,
    -0.08328045904636383,
    -0.01892395131289959,
    -0.030173860490322113,
    -0.07332847267389297,
    -0.06420646607875824,
    0.020086130127310753,
    0.02269851416349411,
    0.011842836625874043,
    0.04830992594361305,
    -0.019947679713368416,
    -0.011910908855497837,
    -0.0669931173324585,
    0.03978031501173973,
    0.004728063475340605,
    -0.07278008759021759,
    -0.009937496855854988,
    0.11833520978689194,
    -0.01100038643926382,
    0.057925090193748474,
    0.02993217296898365,
    -0.04256242513656616,
    0.0015036839758977294,
    -0.029932387173175812,
    0.012087436392903328,
    0.03567306697368622,
    -0.03372034430503845,
    0.06063541769981384,
    0.05608191713690758,
    -0.09461509436368942,
    -0.10874151438474655,
    0.0022879894822835922,
    0.009879941120743752,
    -0.10407699644565582,
    -0.010432969778776169,
    0.037228018045425415,
    0.00044096828787587583,
    -0.020241137593984604,
    0.01619771122932434,
    -0.005172147881239653,
    0.11294694989919662,
    0.045207783579826355,
    0.0033137600403279066,
    -0.02565491758286953,
    -0.018700845539569855,
    0.0009233761229552329,
    0.011436544358730316,
    0.015280281193554401,
    -5.596892194148495e-8,
    -0.08884449303150177,
    0.025761811062693596,
    -0.05536186322569847,
    0.05920231714844704,
    0.04972008988261223,
    -0.06446384638547897,
    0.028218023478984833,
    0.0935225710272789,
    0.07992362976074219,
    -0.0395311564207077,
    0.11999157816171646,
    -0.008120935410261154,
    -0.07932942360639572,
    -0.028203677386045456,
    0.0031409019138664007,
    -0.0586610808968544,
    0.048002276569604874,
    0.03527771309018135,
    -0.07324452698230743,
    -0.01463167741894722,
    -0.028756821528077126,
    -0.06390644609928131,
    -0.009665231220424175,
    -0.04151924327015877,
    -0.007991804741322994,
    -0.013796737417578697,
    0.056526683270931244,
    0.0782683938741684,
    0.04070829600095749,
    -0.006138036958873272,
    0.015179588459432125,
    0.017787355929613113,
    0.05037400498986244,
    -0.0022250220645219088,
    -0.06827852129936218,
    0.03560277074575424,
    0.010088282637298107,
    0.04496266320347786,
    0.04328199848532677,
    0.07717569172382355,
    0.008775726892054081,
    -0.02040676958858967,
    0.02070361003279686,
    0.018381385132670403,
    -0.04305977746844292,
    -0.045106273144483566,
    0.04001455381512642,
    0.016293885186314583,
    0.03479946777224541,
    -0.02167469449341297,
    -0.10958056151866913,
    -0.009863432496786118,
    0.007451377809047699,
    0.07266273349523544,
    0.03768391162157059,
    0.01582672819495201,
    0.09724107384681702,
    -0.04309725761413574,
    0.04224197939038277,
    0.004187877289950848,
    0.05895830690860748,
    -0.04682350531220436,
    -0.009294492192566395,
    0.06941061466932297
  ],
  "text": "### Key Findings:\n\n**Recording Segments Storage:**\n1. `VineRecordingController` maintains `List<RecordingSegment>` internally\n2. Each segment has: filePath, duration, and virtual tracking for macOS\n3. Provider wrapper: `VineRecordingNotifier` in `vine_recording_provider.dart` exposes segments via `segments` getter\n4. Segments are in-memory only during recording session\n\n**Clips Management (Multi-segment recording):**\n1. `ClipManagerService` maintains separate `List<RecordingClip>` for explicit clip management\n2. Used when user records multiple clips and wants to manage them individually\n3. Each clip: id, filePath, duration, orderIndex, recordedAt, thumbnailPath\n4. **Key method:** `clearAll()` in ClipManagerService (line 94-98) - completely empties clips list\n\n**Post-Publish Cleanup:**\n1. In `VideoMetadataScreenPure._publishVideo()` (line 1180):\n   - SUCCESS: `draftService.deleteDraft(_currentDraft!.id)` - removes draft from storage\n   - THEN: `ref.read(vineRecordingProvider.notifier).markAsPublished()` - sets `_wasPublished = true` flag\n   - This prevents auto-save on dispose\n\n2. Current flow after publish:\n   - Navigates to profile screen (line 1203): `context.goMyProfile()`\n   - NO cleanup of recording segments or temp files\n\n**Draft Management:**\n- `DraftStorageService` uses SharedPreferences to persist drafts\n- Drafts contain: videoFile, title, description, hashtags, proofManifestJson\n- When publishing succeeds, draft is deleted\n- Auto-save on dispose if publishing was not marked successful\n\n**Existing Reset/Cleanup:**\n1. `VineRecordingNotifier.reset()` (line 337-342):\n   - Calls `_controller.reset()`\n   - Resets `_wasPublished = false`\n   - Clears `_currentDraftId = null`\n\n2. `VineRecordingNotifier.cleanupAndReset()` (line 355-376):\n   - Calls `_controller.cleanupFiles()` - deletes temp files\n   - Calls `_controller.reset()` - resets state\n   - Clears flags\n\n3. Called when entering camera screen fresh (line 219 in universal_camera_screen_pure.dart)\n\n**GAP IDENTIFIED:**\nAfter publishing succeeds, the code does NOT call any cleanup:\n- Recording segments remain in memory\n- Temp video files may remain on disk\n- Clip manager state is not cleared if user was using it\n- No explicit cleanup before navigating away\n\n**Where cleanup SHOULD happen:**\nEither:\n1. After successful publish, before navigation\n2. In screen dispose when coming from publish flow\n3. Combined in a dedicated \"complete publish workflow\" method\n\n**State tracking after publish:**\n- Draft is deleted from SharedPreferences ✓\n- `_wasPublished` flag set to prevent auto-save ✓\n- Recording provider marked as published ✓\n- BUT: Segments, temp files, and clips still exist ✗",
  "sections": [
    "Project Notes",
    "OpenVine Recording & Publishing Flow Analysis"
  ],
  "timestamp": 1765625538304,
  "path": "/Users/rabble/code/andotherstuff/openvine/mobile/.private-journal/2025-12-14/00-32-18-304074.md"
}