---
title: "4:58:24 PM - December 9, 2025"
date: 2025-12-09T03:58:24.920Z
timestamp: 1765252704920
---

## Project Notes

## Blossom Streaming Upload Fix - Complete (Dec 9, 2025)

### Summary
Successfully fixed Blossom video upload 404 playback issue. Two-part fix:

1. **Client-side fix** (this branch `fix/blossom-streaming-upload`):
   - Changed to use server's returned `sha256` hash as authoritative source for `videoId`
   - Previously used client-computed hash, which could differ for large files going through Cloud Run proxy
   - Added hash mismatch detection logging
   - Changed default server from `blossom.divine.video` to `media.divine.video`
   - Updated test to expect server's hash (was expecting client hash)

2. **Server-side fixes** (deployed by separate agent):
   - Fixed DNS for media.divine.video
   - Enabled HTTP/2 on Cloud Run for 50GB uploads
   - Updated Fastly to allow 50GB uploads
   - Fixed Range Request signing for video playback

### Key Insight
Files >500KB are proxied to Cloud Run which computes its OWN SHA256 from the received bytes. The server returns URL based on server's hash. Client was storing client's pre-computed hash as `videoId`, causing URL mismatch â†’ 404 on playback.

### Verification
- All 17 blossom_upload_service tests pass
- Server returns HTTP 200 for test video hash
- Range requests working for video playback
