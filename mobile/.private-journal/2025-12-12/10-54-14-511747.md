---
title: "10:54:14 AM - December 12, 2025"
date: 2025-12-11T21:54:14.511Z
timestamp: 1765490054511
---

## Project Notes

## Background Upload Implementation Plan Complete

### Files Created/Modified:
1. `docs/plans/2025-12-12-background-downloader-upload.md` - 15-task implementation plan
2. `docs/SERVER_BACKGROUND_UPLOAD_REQUIREMENTS.md` - Server requirements for backend team

### Key Design Decisions (from code review):
- `retries: 0` in UploadTask — UploadManager already handles retry logic; don't double-retry
- No response body parsing — `responseBody` doesn't work for upload tasks in background_downloader
- Android foreground service uses `com.bbflight.background_downloader.BackgroundDownloaderTask` (not the WorkManager service)
- Android 13+ requires runtime notification permission before showing upload notifications
- Use `path` package for cross-platform filename extraction (not `.split('/')`)

### Server Requirements:
- 60-minute max token expiration
- 60-second grace period for expired tokens
- Log grace period usage for monitoring
- Validate token-file hash binding
- Support chunked uploads

### User Preferences Captured:
- Auth token expiration: 60 minutes (not 30 as originally proposed)
- Use background_downloader on iOS, Android, AND macOS
- Battery optimization exemption: reactive only (prompt on failure, not proactively)
- Android notification: always show during uploads
