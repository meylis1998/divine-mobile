---
title: "10:58:39 PM - December 5, 2025"
date: 2025-12-05T09:58:39.332Z
timestamp: 1764928719332
---

## Project Notes

**Cache Strategy PR #310 Investigation**

Found the root cause of "not getting new videos" issue:

1. **NOT caused by this PR** - the feat/new-cache-strategy only adds db_client package for Drift-based caching
2. **Real issue is in flutter_embedded_nostr_relay package**:
   - External relay WebSocket connection dies silently
   - Package doesn't properly handle/detect closed connections
   - Keeps trying to send REQ to dead connections: "Cannot add event after closing"
   - Result: only cached events are returned, no new events from relay

3. Logs showed:
   - 100 events loaded from cache (working)
   - 2 relays connect initially (working)
   - Subscription created (working)
   - Later: "SEVERE: Error sending REQ: Bad state: Cannot add event after closing" (broken)
   - "Database HAS 100 events, but subscription returned 0" (diagnostic confirms broken stream)

4. This is a pre-existing bug in the embedded relay package's external relay connection management, not specific to this branch.

Fix needed in: flutter_embedded_nostr_relay (separate repo)
